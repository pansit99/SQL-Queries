SELECT AUD.Audit_Object_Id AS AUD_OBJ_ID 
			, OBJ_CLS.ObjClass_Name AS VESSEL
			, OBJ_AUD.Obj_Code AS AUD_CODE
			, OBJ_AUD.Obj_Description AS AUD_DESCR
			, AUD.AUDITTYPE_ID AS INSP_TYPE_ID
			, AUDTYP.AUDITTYPE_DESCR AS INSP_TYPE_DESCR
     , CASE 
           WHEN CHARINDEX('CDI', AUD.AUDITTYPE_ID) > 0 THEN 'CDI' 
           WHEN CHARINDEX('PSC', AUD.AUDITTYPE_ID) > 0 THEN 'PSC' 
           WHEN CHARINDEX('SIRE', AUD.AUDITTYPE_ID) > 0 THEN 'SIRE' 
           WHEN CHARINDEX('IISM', AUD.AUDITTYPE_ID) > 0 THEN 'INTERNAL ISM' 
           WHEN CHARINDEX('EISM', AUD.AUDITTYPE_ID) > 0 THEN 'EXTERNAL ISM' 
           WHEN CHARINDEX('EISPS', AUD.AUDITTYPE_ID) > 0 THEN 'EXTERNAL ISPS' 
           WHEN CHARINDEX('IISPS', AUD.AUDITTYPE_ID) > 0 THEN 'INTERNAL ISPS' 
           WHEN CHARINDEX('TMSA', AUD.AUDITTYPE_ID) > 0 THEN 'TMSA' 
           WHEN CHARINDEX('DNV', AUD.AUDITTYPE_ID) > 0 THEN 'DNV' 
           WHEN CHARINDEX('MAS_VER', AUD.AUDITTYPE_ID) > 0 THEN 'MASTER''S VERIFICATION' 
           WHEN CHARINDEX('MV', AUD.AUDITTYPE_ID) > 0 THEN 'MASTER''S VERIFICATION' 
           WHEN CHARINDEX('MAS_NAV', AUD.AUDITTYPE_ID) > 0 THEN 'MASTER''S NAVIGATIONAL AUDIT' 
           WHEN CHARINDEX('TSI', AUD.AUDITTYPE_ID) > 0 THEN 'TSI INSPECTION' 
           WHEN CHARINDEX('MSI', AUD.AUDITTYPE_ID) > 0 THEN 'MSI INSPECTION' 
           ELSE AUD.AUDITTYPE_ID 
       END AS INSP_TYPE_GENERIC 
       			, OBJ_NC.OBJ_CODE AS NC_CODE
			, NC.NCCHAPTER_ID AS NC_CHAPTER
			, NC.NCCHAPTERQUESTION_ID AS NC_QUESTION
			, AUD.AUDIT_DATE aS AUD_DATE
FROM ST_Audit AS AUD 
	INNER JOIN ST_Object AS OBJ_AUD ON OBJ_AUD.Object_Id = AUD.Audit_Object_Id 
	INNER JOIN ST_ObjectClass AS OBJ_CLS ON OBJ_CLS.ObjClass_Id = OBJ_AUD.ObjClass_Id AND OBJ_CLS.Rec_Deleted = 0
	LEFT OUTER JOIN ST_NonConformity AS NC ON NC.Audit_Object_Id = AUD.Audit_Object_Id
	LEFT OUTER JOIN ST_Object AS OBJ_NC ON OBJ_NC.Object_Id = NC.NC_Object_Id 
	LEFT OUTER JOIN ST_Object AS OBJ_PERSON ON OBJ_PERSON.Object_Id = AUD.Audit_RespPersonObjID
	LEFT OUTER JOIN ST_Object AS OBJ_INSPBY ON OBJ_INSPBY.Object_Id = AUD.AUDIT_COMPADDROBJID AND OBJ_INSPBY.ObjType_Id = 120
	LEFT OUTER JOIN ST_AUDITTYPE AS AUDTYP ON AUDTYP.AUDITTYPE_ID = AUD.AUDITTYPE_ID
	LEFT OUTER JOIN ST_Location AS LOC ON LOC.Loc_Code = AUD.AUDIT_PORTOFINSPECTION
	LEFT OUTER JOIN ST_AUDIT_VO AS AUD_OPRN ON AUD_OPRN.AUDIT_VO_ID = AUD.AUDIT_VO_ID
WHERE YEAR(AUD.AUdit_Date) >= 2017
	AND OBJ_CLS.ObjClass_Name NOT IN ('Bow Asia', 'Bow Singapore', 'Bow Fuling', 'Bow Dalian', 'Bow Nangang', 'Bow Victor', 'Bow Aratu', 'Dummy Vessel', 'Ship Management')
ORDER BY VESSEL ASC, AUD_DATE ASC
