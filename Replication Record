--HUB INFO IS FROM ST_DATABASEINFO
SELECT PLT.Plant_Name AS VESSEL
     , CONVERT(varChar, DBI.DB_REPLSENDSEQ) + ' - ' + CONVERT(varChar, DBI.DB_REPLSENDDATE) AS 'HUB SEND'
     , CONVERT(int, GetDate() - DBI.DB_REPLSENDDATE) AS 'HS_DAYS'
     , CONVERT(varChar, DBI.DB_REPLRECSEQ) + ' - ' + CONVERT(varChar, DBI.DB_REPLRECDATE) AS 'HUB RECEIVE'
     , CONVERT(int, GetDate() - DBI.DB_REPLRECDATE) AS 'HR_DAYS'
     , (SELECT TOP(1) CONVERT(varChar, DB_REPLSENDSEQ) + ' - ' + CONVERT(varChar, DB_REPLSENDDATE) 
	FROM ST_DATABASEINFOLOG 
	WHERE DB_ID = DBI.DB_ID 
		AND Rec_Deleted = 0 
		AND (CHARINDEX('\sis\', DB_REPLSENDPATH) > 0
		 OR CHARINDEX('\StarIPS\', DB_REPLSENDPATH) > 0)
	ORDER BY DBINFOLOG_DATE DESC) AS 'VESSEL SEND'
     , (SELECT TOP(1) CONVERT(int, GetDate() - DB_REPLSENDDATE)
	FROM ST_DATABASEINFOLOG 
	WHERE DB_ID = DBI.DB_ID 
		AND Rec_Deleted = 0 
		AND (CHARINDEX('\sis\', DB_REPLSENDPATH) > 0
		 OR CHARINDEX('\StarIPS\', DB_REPLSENDPATH) > 0)
	ORDER BY DBINFOLOG_DATE DESC) AS 'VS_DAYS'
     , (SELECT TOP(1) CONVERT(varChar, DB_REPLRECSEQ) + ' - ' + CONVERT(varChar, DB_REPLRECDATE) 
	FROM ST_DATABASEINFOLOG 
	WHERE DB_ID = DBI.DB_ID 
		AND Rec_Deleted = 0 
		AND (CHARINDEX('\sis\', DB_REPLSENDPATH) > 0
		 OR CHARINDEX('\StarIPS\', DB_REPLSENDPATH) > 0)
	ORDER BY DBINFOLOG_DATE DESC) AS 'VESSEL RECEIVE'
     , (SELECT TOP(1) CONVERT(int, GetDate() - DB_REPLRECDATE)
	FROM ST_DATABASEINFOLOG 
	WHERE DB_ID = DBI.DB_ID 
		AND Rec_Deleted = 0 
		AND (CHARINDEX('\sis\', DB_REPLSENDPATH) > 0
		 OR CHARINDEX('\StarIPS\', DB_REPLSENDPATH) > 0)
	ORDER BY DBINFOLOG_DATE DESC) AS 'VR_DAYS'
FROM ST_DATABASEINFO AS DBI 
   INNER JOIN ST_PLANT AS PLT ON PLT.DB_ID = DBI.DB_ID
WHERE DBI.DB_Active = -1
   AND PLT.Rec_Deleted = 0 
ORDER BY PLT.Plant_Name
