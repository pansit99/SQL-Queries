 -- RETURNS LIST OF REPLICATION RECORD FOR CURRENT DATE AND TIME
 
  SELECT "ST_PLANT"."Plant_Name" AS 'VESSEL'
	, CONVERT(varChar, "ST_DATABASEINFO"."DB_ReplSendSeq") AS 'HUB SEND SEQUENCE'
	, "ST_DATABASEINFO"."DB_ReplSendDate" AS 'HUB SEND DATE'
	, CONVERT(int, GetDate() - "ST_DATABASEINFO"."DB_ReplSendDate") AS 'HSD SINCE'
	, CONVERT(varChar, "ST_DATABASEINFO"."DB_ReplRecSeq") AS 'HUB RECEIVE SEQUENCE'
	, "ST_DATABASEINFO"."DB_ReplRecDate" AS 'HUB RECEIVE DATE'
	, CONVERT(int, GetDate() - "ST_DATABASEINFO"."DB_ReplRecDate") AS 'HRD_SINCE'
	, CONVERT(varChar, (SELECT TOP(1) DB_REPLRECSEQ FROM ST_DATABASEINFOLOG WHERE DB_ID = ST_PLANT.DB_ID AND REC_DELETED = 0 ORDER BY DBINFOLOG_DATE DESC)) AS 'VESSEL RECEIVE SEQUENCE'
	, (SELECT TOP(1) DB_REPLRECDATE FROM ST_DATABASEINFOLOG WHERE DB_ID = ST_PLANT.DB_ID AND REC_DELETED = 0 ORDER BY DBINFOLOG_DATE DESC) AS 'VESSEL RECEIVE DATE'
	, CONVERT(int, GetDate() - (SELECT TOP(1) DB_REPLRECDATE FROM ST_DATABASEINFOLOG WHERE DB_ID = ST_PLANT.DB_ID AND REC_DELETED = 0 ORDER BY DBINFOLOG_DATE DESC)) AS 'VRD_SINCE'
	, CONVERT(varChar, (SELECT TOP(1) DB_REPLSENDSEQ FROM ST_DATABASEINFOLOG WHERE DB_ID = ST_PLANT.DB_ID AND REC_DELETED = 0 ORDER BY DBINFOLOG_DATE DESC)) AS 'VESSEL SEND SEQUENCE'
	, (SELECT TOP(1) DB_REPLSENDDATE FROM ST_DATABASEINFOLOG WHERE DB_ID = ST_PLANT.DB_ID AND REC_DELETED = 0 ORDER BY DBINFOLOG_DATE DESC) AS 'VESSEL SEND DATE'
	, CONVERT(int, GetDate() - (SELECT TOP(1) DB_REPLSENDDATE FROM ST_DATABASEINFOLOG WHERE DB_ID = ST_PLANT.DB_ID AND REC_DELETED = 0 ORDER BY DBINFOLOG_DATE DESC)) AS 'VSD_SINCE'
	, (SELECT TOP(1) DBINFOLOG_DATE FROM ST_DATABASEINFOLOG WHERE DB_ID = ST_PLANT.DB_ID AND REC_DELETED = 0 ORDER BY DBINFOLOG_DATE DESC) AS 'RECORD DATE'
 FROM   (ST_DATABASEINFO INNER JOIN ST_PLANT ON ST_DATABASEINFO.DB_Id = ST_PLANT.DB_Id) 
 WHERE  ST_DATABASEINFO.DB_Active =-1 
	AND ST_PLANT.Rec_Deleted =0 
 ORDER BY ST_PLANT.Plant_Name ASC, 'RECORD DATE' DESC
